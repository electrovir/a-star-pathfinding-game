(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(t,e,i){t.exports=i(26)},17:function(t,e,i){},23:function(t,e,i){t.exports=i.p+"static/media/spritesheet.f9ce9100.png"},24:function(t,e,i){t.exports=i.p+"static/media/theDude.7e8a22ae.png"},25:function(t,e,i){t.exports=i.p+"static/media/TurretR.fb7e1ad9.png"},26:function(t,e,i){"use strict";i.r(e);var n=i(0),r=i.n(n),o=i(11),a=i.n(o),s=(i(17),i(1)),c=i(4),h=i(7),u=i(5),d=i(8),l=i(9),p=i(2),g=i(3),f=i.n(g),x=i(6),y=new function t(){var e=this;Object(s.a)(this,t),this._prt=function(){var t=Object(x.a)(f.a.mark(function t(e){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(t){return new Promise(function(e){return setTimeout(e,t)})}(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),this._randInt=function(t,e){return Math.floor(Math.random()*(e-t)+t)},this._getRandomGridBox=function(t){var i=null;for(var n in t)console.log(n),e._randInt(0,100)>70&&(i=t[n]);return i||e._getRandomGridBox()},this.nDirections={0:"NORTH_WEST",1:"WEST",2:"SOUTH_WEST",3:"NORTH",5:"SOUTH",6:"NORTH_EAST",7:"EAST",8:"SOUTH_EAST"},this.config={grid:{_getRandomTypeConstant:function(){return[0,0,2,0,2,2,1,0,0,0,2,0,0,0,3,0,0,2,0,0][Math.floor(19*Math.random())+1]},gridTypes:{0:{type:"walkable",const:0,passable:!0,friction:0,damage:0,color:"#d2d2d2",sprite:{x:0,y:0,width:50,height:50,type:0}},1:{type:"walkableSlow",const:1,passable:!0,friction:Number((.5*Math.random()+.3).toFixed(2)),damage:0,color:"#80cccc",sprite:[{x:100,y:0,width:50,height:50,type:1},{x:100,y:50,width:50,height:50,type:1},{x:100,y:100,width:50,height:50,type:1}][this._randInt(1,3)-1]},2:{type:"blocked",const:2,passable:!1,friction:0,damage:0,color:"#7a7a7a",sprite:[{x:50,y:0,width:50,height:50,type:2},{x:50,y:50,width:50,height:50,type:2},{x:50,y:100,width:50,height:50,type:2}][this._randInt(1,3)-1]},3:{type:"damage",passable:!0,const:3,friction:Number((.5*Math.random()+.3).toFixed(2)),damage:Number((.5*Math.random()+.25).toFixed(2)),color:"#c4341b",sprite:[{x:150,y:0,width:50,height:50,type:3},{x:150,y:50,width:50,height:50,type:3},{x:150,y:100,width:50,height:50,type:3}][this._randInt(1,3)-1]}}},char:{charTypes:{0:{type:"ninja",const:0,width:50,height:50,spriteSet:{down:{x:0,y:0,width:56,height:72},up:{x:0,y:74,width:53,height:72},left:{x:0,y:146,width:53,height:72},right:{x:0,y:219,width:53,height:72}}}}},turret:{turretTypes:{0:{type:"gunner",const:0,width:50,height:50,sprite:{x:0,y:0,width:100,height:50}}}}}},_=function(t){var e=t.game,i=t.utils;return{GridBox:function(t){var n=this,r=t.key,o=t.gX,a=t.gY,s=t.x,c=t.y,h=t.width,u=t.height,d=t.type,l=t.passable,p=t.friction,g=t.damage,f=t.color,x=t.sprite;this.key=r,this.gX=o,this.gY=a,this.x=s||0,this.y=c||0,this.width=h||0,this.height=u||0,this.type=d,this.passable=l,this.friction=p,this.damage=g,this.color=f,this.sprite=x,this.origSprite=Object.assign({},x),this._resetSprite=function(){return n.sprite=n.origSprite},this.gScore=0,this.hScore=0,this.fScore=0,this.parentZone={},this._setParent=function(t){return n.parentZone=t},this._clearParent=function(){return n.parentZone=null},this.isSelected=!1,this._select=function(){return n.isSelected=!0},this._deselect=function(){return n.isSelected=!1},this.isSource=!1,this.isNextSource=!1,this._setNextSource=function(){return n.isNextSource=!0},this._setSource=function(){n.isSource=!0,n.sprite={x:0,y:50,width:50,height:50,type:0},e.heroPosition=n,n.isNextSource&&(n.isNextSource=!1)},this._clearSource=function(){n.isSource=!1,n.sprite=n.origSprite,delete e.heroPosition},this.isRaySource=!1,this._setRaySource=function(){return n.isRaySource=!0},this.isDestination=!1,this.isNextDestination=!1,this._setNextDestination=function(){return n.isNextDestination=!0},this._setDestination=function(){n.isDestination=!0,n.sprite={x:0,y:100,width:50,height:50,type:0},e.heroDestination=n,n.isNextDestination&&(n.isNextDestination=!1)},this._clearDestination=function(){n.isDestination=!1,n.sprite=n.origSprite,delete e.heroDestination},this._setNearestState=function(){return n.isDestination?null:n.sprite={x:0,y:150,width:50,height:50,type:0}},this._setNeighborState=function(){return n.isDestination?null:n.sprite={x:0,y:200,width:50,height:50,type:0}},this._getNeighbors=function(){for(var t=n.gX,r=n.gY,o=[],a=0,s=t-1;s<=t+1;s++)for(var c=r-1;c<=r+1;c++)if(s<0||c<0||s>15||c>11||s===n.gX&&c===n.gY)a++;else{var h=e.gridHash["".concat(s,"-").concat(c)];0!==a&&2!==a&&6!==a&&8!==a?(h.direction=i.nDirections[a],o.push(h),a++):a++}return o}},CharBox:function(t){var e=this,i=t.x,n=t.y,r=t.width,o=t.height,a=t.type,s=t.color,c=t.sprite,h=t.spriteSet;this.x=i||0,this.y=n||0,this.width=r||0,this.height=o||0,this.type=a,this.color=s||"rgba(255,255,255,0)",this.sprite=c,this.spriteSet=h,this._setDirection=function(t){e.sprite=e.spriteSet[{NORTH:"up",SOUTH:"down",EAST:"right",WEST:"left"}[t||"SOUTH"]]}}}},w=function(t){var e=t.game,i=t.utils;return new function t(){var n=this;Object(s.a)(this,t),this._findPath=function(){n.allDone&&e._resetGrid(),console.log("starting path"),console.log(e.heroPosition),console.log(e.heroDestination),e.findingPath=!0,n.allDone=!1,n._iterations=0,n._nextNearest=null,n.opened=[],n.closed=[],n.path={},n.opened.push(e.heroPosition),n._iteratePath()},this._finishPath=function(){e.heroDestination._setNextSource(),e.findingPath=!1,n.allDone=!0,console.log("completed path")},this._iteratePath=Object(x.a)(f.a.mark(function t(){var r,o;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.allDone){t.next=2;break}return t.abrupt("return");case 2:return r=-1,t.next=5,i._prt(300);case 5:if(n.opened.forEach(function(t){(-1===r||t.fScore<r)&&(r=t.fScore,n._nextNearest=t)}),e.heroTweenA&&e._tweenHero(n._nextNearest),!n._nextNearest.isDestination){t.next=12;break}return n._finishPath(),t.abrupt("return");case 12:(o=n.opened.find(function(t){return t.key===n._nextNearest.key}))&&(n.opened=n.opened.filter(function(t){return t.key!==n._nextNearest.key}),n.closed.push(o),n.path[o.key]=o),n._nextNearest._getNeighbors().forEach(function(t){"blocked"===t.type||t.isSource||n.closed.find(function(e){return e.key===t.key})||(n.opened.find(function(e){return e.key===t.key})?n._nextNearest.gScore+n._calcGScore(t)<t.gScore&&(t.parentZone=n._nextNearest,t.gScore=n._nextNearest.gScore+n._calcGScore(t),t.fScore=n._calcFScore(t)):(n.opened.push(t),e.showPath&&(t._setNeighborState(),n._nextNearest._setNearestState()),t.parentZone=n._nextNearest,t.gScore=(t.parentZone.gScore||0)+n._calcGScore(t),t.hScore=n._calcHScore(t),t.fScore=n._calcFScore(t))),e.gridHash[t.key].gScore=t.gScore}),(!n.opened.length||n._iterations>800)&&(n.allDone=!0),n._iterations++,n.allDone||n._iteratePath();case 19:case"end":return t.stop()}},t,this)})),this._calcFScore=function(t){return t.gScore+t.hScore},this._calcHScore=function(t){return 10*(Math.abs(t.x-e.heroDestination.x)+Math.abs(t.y-e.heroDestination.y))},this._calcGScore=function(t){var e=t.direction,i=t.type,n=0;switch(e){case"NORTH":case"SOUTH":case"WEST":case"EAST":n+=10;break;case"NORTH_EAST":case"NORTH_WEST":case"SOUTH_EAST":case"SOUTH_WEST":n+=20}return"walkableSlow"===i&&(n+=20),"damage"===i&&(n+=40),n}}},S=i(21),m=new Image;m.src=i(23);var v=new Image;v.src=i(24),(new Image).src=i(25);var b=function(t){function e(){var t;return Object(s.a)(this,e),(t=Object(h.a)(this,Object(u.a)(e).call(this))).componentWillMount=function(){t.mode=t.props.mode||"pathfind"},t.componentDidMount=function(){"pathfind"===t.mode&&(t.showPath=!0,t.showScore=!0,t.heroTweenA=!0),"raycast"===t.mode&&(t.showPath=!1,t.showScore=!1,t.heroTweenA=!0),t._initializeGameCanvas()},t._initializeGameCanvas=function(){t.canvas=t.refs.g_canvas,t.ctx=t.canvas.getContext("2d"),t.gridHash=t._initGrid({rows:12,cols:16,t_width:800,t_height:600}),t.hero=t._initHero(),t.canvas.addEventListener("click",function(e){var i={x:Math.ceil(e.clientX/50)-1,y:Math.ceil(e.clientY/50)-1},n="".concat(i.x,"-").concat(i.y),r=t.gridHash[n];"walkable"===r.type&&(t.findingPath||(t.heroDestination&&t.heroDestination.key!==r.key?r._setNextDestination():r._setDestination(),t.PF._findPath()))}),"raycast"===t.mode&&(t.mPosition={x:0,y:0},t.canvas.addEventListener("mousemove",function(e){t.mPosition.x=e.clientX,t.mPosition.y=e.clientY})),window.addEventListener("keypress",function(e){"p"===e.key&&(t.isPaused?(t.isPaused=!1,t._renderLoop()):(t.isPaused=!0,cancelAnimationFrame(t.frameId)))}),t._renderLoop()},t._renderLoop=function(e){t._drawRender(),S.update(e),t.frameId=requestAnimationFrame(t._renderLoop)},t._drawRender=function(){t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t._drawGrid(),t._drawBox("hero",t.hero),"raycast"===t.mode&&t._drawRay({x:t.hero.x+25,y:t.hero.y+25})},t._drawRay=function(e){var i=Math.atan2(t.mPosition.y-e.y,t.mPosition.x-e.x);t.ctx.strokeStyle="#FF0000",t.ctx.beginPath(),t.ctx.moveTo(e.x,e.y),t.ctx.lineTo(t.mPosition.x,t.mPosition.y),t.ctx.stroke(),t._detectCollisions(i)},t._detectCollisions=function(e){t.hitBoxes=[];for(var i=1;i<1111;i+=15){var n=(t.hero.x+i)*Math.cos(e),r=(t.hero.y+i)*Math.sin(e),o={x:Math.ceil(n/50)-1+t.heroPosition.gX,y:Math.ceil(r/50)-1+t.heroPosition.gY};if(o.x<t.heroPosition.gX?(t.hitBoxes.push("".concat(o.x+1,"-").concat(o.y)),t.hitBoxes.push("".concat(o.x+2,"-").concat(o.y))):o.x>t.heroPosition.gX?(t.hitBoxes.push("".concat(o.x-1,"-").concat(o.y)),t.hitBoxes.push("".concat(o.x-2,"-").concat(o.y))):t.hitBoxes.push("".concat(o.x,"-").concat(o.y)),o.x>15||o.y>11)break}for(var a in t.hitBoxes=t.hitBoxes.filter(function(t,e,i){return i.indexOf(t)===e}),t.gridHash)t.gridHash[a]._resetSprite();t.hitBoxes.forEach(function(e){return t.gridHash[e]?t.gridHash[e]._setNeighborState():null}),console.log(t.hitBoxes)},t._drawBox=function(e,i){if(i)switch(e){case"grid":return t.ctx.fillRect(i.x,i.y,i.width,i.height),t.ctx.drawImage(m,i.sprite.x,i.sprite.y,i.sprite.width,i.sprite.height,i.x,i.y,i.width,i.height),void(i.gScore&&t.showScore&&(t.ctx.font="20px Arial",t.ctx.fillStyle="walkableSlow"===i.type?"#603F39":"damage"===i.type?"#F07E2D":"#FFF",t.ctx.fillText(i.gScore,i.x+5,i.y+20)));case"hero":return t.ctx.fillStyle=i.color,t.ctx.fillRect(i.x,i.y,i.width,i.height),void t.ctx.drawImage(v,i.sprite.x,i.sprite.y,i.sprite.width,i.sprite.height,i.x,i.y,i.width,i.height);default:return}},t._drawGrid=function(){return Object.values(t.gridHash).forEach(function(e){return t._drawBox("grid",e)})},t._initGrid=function(e){for(var i=e.rows,n=e.cols,r=e.t_width/n,o=e.t_height/i,a={},s=0;s<=i-1;s++)for(var c=0;c<=n-1;c++){var h="".concat(c,"-").concat(s),u=c,d=s,p=c*r,g=s*o,f=y.config.grid.gridTypes[y.config.grid._getRandomTypeConstant()],x=new t.Classes.GridBox(Object(l.a)({key:h,gX:u,gY:d,x:p,y:g,width:r,height:o},f));!t.heroPosition&&y._randInt(1,20)>15&&"walkable"===x.type&&(x._setSource(),t.heroPosition=x),a[h]=x}return a},t._resetGrid=function(){var e,i;for(var n in console.log("resetting"),t.gridHash){var r=t.gridHash[n];r.isNextSource&&(e=r),r.isNextDestination&&(i=r),r.sprite=r.origSprite,r.gScore=0,r.hScore=0,r.fScore=0,r._deselect(),r._clearParent(),r._clearDestination(),r._clearSource()}delete t.heroPosition,delete t.heroDestination,e._setSource(),i._setDestination()},t._initHero=function(){var e=t.heroPosition,i=e.x,n=e.y,r=y.config.char.charTypes[0];return new t.Classes.CharBox(Object(l.a)({x:i,y:n,sprite:r.spriteSet.down},r))},t._tweenHero=function(e,i){var n;if(e)return n=new S.Tween(t.hero).to({x:e.x,y:e.y},360),t.hero._setDirection(e.direction),n.start();i.map(function(t){return t.split("-")}).forEach(function(e){n=new S.Tween(t.hero).to({x:e[0],y:e[1]},320).start()})},t.PF=w({game:Object(p.a)(Object(p.a)(t)),utils:y}),t.Classes=_({game:Object(p.a)(Object(p.a)(t)),utils:y}),t.isPaused=!1,t.mode=null,t}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("canvas",{id:"g_canvas",ref:"g_canvas",width:"800",height:"600"}))}}]),e}(n.Component),T=function(t){function e(){return Object(s.a)(this,e),Object(h.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{style:{width:"800px",height:"600px",display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(b,{mode:"pathfind"}))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[12,2,1]]]);
//# sourceMappingURL=main.e243119d.chunk.js.map